SEL *
FROM (
		SEL
		{IBM_STG_TABLE_COLUMNS}
		FROM GTST1T_IBM.{TABLE_NAME} IBM_STG_TABLE

		QUALIFY ROW_NUMBER() OVER (PARTITION BY {TBL_PKs} ORDER BY IBM_STG_TABLE.BATCH_ID DESC,{QUALIFY_ORDERING},REF_KEY DESC)=1
UNION ALL
		(
			SEL
			{TERADATA_STG_TABLE_COLUMNS}
			FROM GDEVP1T_STG.{TABLE_NAME} TERADATA_STG_TABLE
		UNION ALL
			SEL
			{TERADATA_WRK_TABLE_COLUMNS}
			FROM {WRK_DATABASE}.{TABLE_NAME} TERADATA_WRK_TABLE
		)
	)TST
GROUP BY {COUNT_COLS}
HAVING COUNT(*) = 1;